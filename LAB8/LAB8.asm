STACK SEGMENT
    DB 100h DUP(?)
STACK ENDS

DATA SEGMENT
    ROWS DB 16
    NEWLINE DB 13,10,'$'
DATA ENDS

CODE SEGMENT
    ASSUME CS:CODE,DS:DATA,SS:STACK
START:
    MOV AX,DATA
    MOV DS,AX

    MOV CX,128
    MOV BX,128
PRINT_SECOND_HALF:
    MOV AL,BL
    CALL PRINT_CHAR

    INC BL
    DEC CX
    JE PRINT_FIRST_HALF

    MOV AX,CX
    MOV DX,16
    XOR DX,DX
    MOV DX,AX
    DIV ROWS
    CMP DX,0
    JNE CONTINUE_SECOND
    LEA DX,NEWLINE
    MOV AH,09h
    INT 21h

CONTINUE_SECOND:
    JMP PRINT_SECOND_HALF
PRINT_FIRST_HALF:
    MOV CX,128
    XOR BX,BX
PRINT_FIRST_LOOP:
    MOV AL,BL
    CALL PRINT_CHAR

    INC BL
    DEC CX
    JE DONE

    MOV AX,CX
    MOV DX,16
    XOR DX,DX
    MOV DX,AX
    DIV ROWS
    CMP DX,0
    JNE CONTINUE_FIRST
    LEA DX,NEWLINE
    MOV AH,09h
    INT 21h
CONTINUE_FIRST:
    JMP PRINT_FIRST_LOOP
DONE:
    MOV AH,4CH
    INT 21
    PRINT_CHAR ;description
MOV AH,02h PROC
        
    MOV AH,02h
    INT 21h
    RET
    PRINT_CHAR ENDP
    CODE ENDS
    END START 